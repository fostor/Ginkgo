(function(){$(function(){function t(n){r=$("#table_100").DataTable({data:n,destroy:!0,searching:!0,dom:"Bftir",language:$.getDataTableLang(),buttons:$.getDataTableButtons(),deferRender:!0,scrollY:$(window).height()-310,scrollX:!0,scrollCollapse:!0,scroller:!0,columns:[{data:"phaseCode",width:"80px"},{data:"phaseName",width:"80px"},{orderable:!1,bSortable:!1,data:"id",width:"35px",render:function(n,t,i){var r='<div style="text-align:center;" >';return r+='   <a href="#" class="waves-effect waves-block edit-phase-route" data-code="'+encodeURI(JSON.stringify(i))+'"  data-toggle="modal" data-target="#MyFlowPhaseEditModal" ><i class="tiny material-icons">visibility<\/i><\/a>',r+"<\/div>"}},{data:"actors"}],initComplete:function(){u();$.setTableSelectedRowsCss("table_100")}})}function u(){$(".edit-phase-route").click(function(n){n.preventDefault();var t=JSON.parse(decodeURI($(this).attr("data-code")));$.ajax({url:abp.appPath+"TaskFlow/Flow/EditMyFlowPhase?taskCode="+t.taskCode+"&phaseCode="+t.phaseCode,type:"POST",contentType:"application/html",success:function(n){$("#MyFlowPhaseEditModal div.modal-content").html(n)},error:function(){}})})}var n,i,r;$("#main_panel").height($(window).height()-200);$("#flowtree_container").height($(window).height()-225);$("#route_panel").height($(window).height()-225);n=abp.services.app.taskPhase;i=$("#flow_list_data").val();$("#flowtree").treeview({data:i,showBorder:!1,color:"#3F51B5",levels:1,nodeIcon:"glyphicon glyphicon-th-list",onNodeSelected:function(i,r){$("#lb_flow_route").text("["+r.code+"]");$("#txt_task_code").val(r.code);n.getMyTaskFlow(r.code).done(function(n){t(n)})}});r=null;t(null);$("#MyFlowPhaseEditModal").on("hide.bs.modal",function(){var r=$(this).find(".save-button").hasClass("save-clicked"),i;r&&(i=$("#txt_task_code").val(),n.getMyTaskFlow(i).done(function(n){t(n)}))})})})();