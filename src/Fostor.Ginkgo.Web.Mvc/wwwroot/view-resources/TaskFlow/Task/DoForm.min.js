(function(){$(function(){function r(){$.ajax({url:abp.appPath+n.find("input[name=FormUri]").val(),type:"POST",contentType:"application/html",success:function(n){$("#form-info-panel").html(n)},error:function(){}})}function u(){var e;if(n.valid()){var o=n.find("input[name=InstanceCode]").val(),s=n.find("input[name=Memo]").val(),u=n.find("select[name=NextPhaseActors]").val(),f=n.find("select[name=ToReturnActors]").val(),r="0";if($("#radio_1").is(":checked")&&(r="1"),$("#radio_2").is(":checked")&&(r="2"),$("#radio_3").is(":checked")&&(r="3"),r=="0")return!1;if(r=="1"&&u&&u.length<3)return abp.message.warn(abp.localization.localize("PleaseSelectNextActor","Ginkgo")),!1;if(r=="2"&&f&&f.length<3)return abp.message.warn(abp.localization.localize("PleaseSelectReturnActor","Ginkgo")),!1;e={instanceCode:o,memo:s,handleResult:r,nextActors:u,returnedActor:f};abp.ui.setBusy(n);i.send(e).done(function(n){var i,r;n&&(i=n.followedServiceConfig,i&&i.length>0?(r=JSON.parse(i),abp.services.app[r.service][r.method](r.params).done(function(){t()})):t())})}}function t(){if(history.length>1){var t=location.href,n=1;t.indexOf("#")>0&&(n+=1);history.go(-n)}else window.close()}var i=abp.services.app.taskInstance,n=$("form[name=DoFlowForm]");r();$(".save-button").click(function(n){n.preventDefault();u()});$(".close-button").click(function(n){n.preventDefault();t()})})})();